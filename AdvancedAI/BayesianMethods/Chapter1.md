---
export_on_save:
 html: true
---
@import "/blog_head.md"


# 第一章 贝叶斯推断的哲学

从 20 世纪 80 年代末到 90 年代，人工智能领域出现了 3 个最重要的进展：深度神经网络、贝叶斯概率图模型和统计学习理论。

如果我们最终要进行贝叶斯推断，那么一方面我们可以采用数学分析来实现这一目的，另一方面，随着计算成本的下降，我们已经可以通过概率编程来完成这一任务。后一种方法更加有用，因为它避免了在每一步介入数学干预，而这也使得进行贝叶斯推断不再以通常很棘手的数学分析为前提。

简而言之，后一种计算途径，是从问题起点经过小幅中间步骤到达问题终点，而前一种途径则大幅跃进，并通常最后远离目标。此外，如果没有深厚的数学功底，也改变无法完成前一种途径所需要的数学分析。

## 1.1 引言

简单地说，贝叶斯推断是通过新得到的证据不断地更新你的信念。贝叶斯推断很少会做出绝对的判断，但可以做出非常可信的判断。

贝叶斯推断的工作方式就是：我们会随着新证据的出现，不断更新之前的信念，但很少会做出绝对的判断，除非所有其他可能都被一一排除。

### 1.1.1 贝叶斯思维

和更传统的统计推断不同，贝叶斯推断会保留不确定性。

在贝叶斯派的世界观中，概率被解释为我们队一件事情发生的相信程度，即我们对此事件发生的信心。

频率派是更古典的统计学派，他们认为概率是事件在长时间内发生的频率。例如，在频率派的哲学语境中，飞机事故的概率指的是长期来看，飞机事故的频率值。

对于许多事件来说，这样解释概率是有逻辑的，但对于某些没有长期频率的事件来说，这样解释是难以理解的。例如：在总统选举时，我们经常提及某某候选人获选的概率，但选举制发生一次！频率论为了解决这个问题，提出了“替代现实”的说法。

贝叶斯派将概率解释为对事件发生的信心。简单地说，概率是观点的概述。某人把概率 0 赋给某个事件的发生，表明他完全不相信这个事件会发生。

为了和传统的概率术语对齐，我们把对一个事件 A 发生的信念记为 $P(A)$，这个值我们称为 **先验概率**。

我们会随着证据而更新信念，甚至是，即便证据和初始的信念相反，也不能忽视证据，我们用 $P(A|X)$ 表示更新后的信念，其含义是在得到证据 $X$ 后，A 事件的概率。为了和先验概率相对，我们称更新后的信念为后验概率。

### 1.1.2 贝叶斯推断在实践中的应用

如果频率推断和贝叶斯推断是一种编程函数，输入是各种统计问题，那么这两个函数返回的结果可能是不同的。频率推断返回一个估计值（通常是统计量，平均值是一个典型的例子），而贝叶斯推断会返回概率值。

让 N 表示我们拥有证据的数量。如果 N 趋向于无穷大，那么贝叶斯的结果通常和频率派的结果一致。

### 1.1.3 频率派的模型是错误的码？

不是。频率方法仍然非常有用，在很多领域，可能都是很好的方法。例如最小方差线性回归、LASSO 回归、EM 算法，这些都是非常有效和快速的方法。贝叶斯方法能够在这些方法失效的场景发挥作用，或者是作为更有弹性的模型而补充。

### 1.1.4 关于大数据

出人意料的是，通常解决大数据预测问题的方法都是相对简单的算法，因此，我们会认为大数据预测的难点不在于算法，而是在于大规模数据的存储和计算。

中等规模或者更小规模的数据会使得分析变得更为困难。用类似 Gelman 的话说，如果用大数据问题能够被大数据方法简单直接地解决，那么我们应该更关注不那么大的数据集上的问题。

## 我们的贝叶斯框架

贝叶斯定理：
$$
\begin {aligned}
P(A|X)&=\frac{P(X|A)\cdot P(A)}{P(X)} \\
&\propto P(X|A)\cdot P(A)
\end {aligned}
$$
上面的公式并不等同于贝叶斯推论，它是一个存在于贝叶斯推论之外的数学真理。在贝叶斯推论中，它仅仅被用来连接先验概率 $P(A)$ 和更新的后验概率 $P(A|X)$。



## PyMC 库

PyMC 是一个做贝叶斯分析使用的 Python 库。

在 PyMC 中模型组件为第一类原语，Cronin 对概率编程有一段激动人心的描述：“换一种方式思考这件事情，跟传统的编程仅仅向前运行不同的是，概率编程既可以向前，也可以向后运行。它通过向前运行来计算其中包含的所有关于世界的假设结果，但它也从数据中向后运行，以约束可能的解释。在实践中，许多概率编程系统将这些向前和向后的操作巧妙地交织在一起，以给出有效的最佳解释。”
